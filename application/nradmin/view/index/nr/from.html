<script>
$nr.cms={
  /*共享*/
  public:{
    nv:function(nrdd){ /*共享*/
      nrdd=nrdd.split("|");
      nrarr="";
      for(nrx in nrdd){
        nrrs=nrdd[nrx].split(":");
        nrarr[0]={name:nrrs[0],vlaue:nrrs[1]};
      }
      return nrarr;  
    },
    listinfo:function(nrdd){
      return nrdd?'<div class="panel-lead">'+nrdd+'</div>':'';
    }, 
    listnav:function(nrdd){
      nrhtm='';
      if(nrdd){
        for(nrx in nrdd.data) {
          nrhtm+='<li'+(nrdd.value==nrdd.data[nrx].vlaue?' class="active"':'')+'><a href="#all" data-toggle="tab" aria-expanded="true"'+$nr.route.url('form-input|'+nrdd.type+'|'+nrdd.data[nrx].vlaue)+'>'+nrdd.data[nrx].name+'</a></li> '; 
        }
        nrhtm='<ul class="nav nav-tabs">'+nrhtm+'</ul>';
      }
      return nrhtm;
    },
    head_input:function(nrdd){
        return '<div class="commonsearch-table"><fieldset> <div class="row"> <div class="form-group col-xs-12 col-sm-6 col-md-4 col-lg-3"> <label for="username" class="control-label col-xs-4">用户名</label> <div class="col-xs-8"> <input type="hidden" class="form-control operate" name="username-operate" data-name="username" value="=" readonly=""> <input type="text" class="form-control" name="username" value="" placeholder="用户名" id="username" data-index="2"> </div> </div> <div class="form-group col-xs-12 col-sm-6 col-md-4 col-lg-3"> <label for="title" class="control-label col-xs-4">标题</label> <div class="col-xs-8"> <input type="hidden" class="form-control operate" name="title-operate" data-name="title" value="LIKE %...%" readonly=""> <input type="text" class="form-control" name="title" value="" placeholder="模糊搜索" id="title" data-index="3"> </div> </div> <div class="form-group col-xs-12 col-sm-6 col-md-4 col-lg-3"> <label for="url" class="control-label col-xs-4">Url</label> <div class="col-xs-8"> <input type="hidden" class="form-control operate" name="url-operate" data-name="url" value="=" readonly=""> <input type="text" class="form-control" name="url" value="" placeholder="Url" id="url" data-index="4"> </div> </div> <div class="form-group col-xs-12 col-sm-6 col-md-4 col-lg-3"> <label for="ip" class="control-label col-xs-4">IP</label> <div class="col-xs-8"> <input type="hidden" class="form-control operate" name="ip-operate" data-name="ip" value="=" readonly=""> <input type="text" class="form-control" name="ip" value="" placeholder="IP" id="ip" data-index="5"> </div> </div> <div class="form-group col-xs-12 col-sm-6 col-md-4 col-lg-3"> <label for="createtime" class="control-label col-xs-4">创建时间</label> <div class="col-xs-8"> <input type="hidden" class="form-control operate" name="createtime-operate" data-name="createtime" value="RANGE" readonly=""> <input type="text" class="form-control datetimerange" name="createtime" value="" placeholder="创建时间" id="createtime" data-index="7"> </div> </div> <div class="form-group col-xs-12 col-sm-6 col-md-4 col-lg-3"> <div class="col-sm-8 col-xs-offset-4"> <button type="submit" class="btn btn-success" formnovalidate="" data-eurl="submit">提交</button> <button type="reset" class="btn btn-default">重置</button> </div> </div> </div> </fieldset> </div>';
    },

    listsetleft:function(nrdd){ 
        this.btn=function(nrdd){
        return ' <a href="javascript:;" class="btn btn-primary btn-refresh" title="刷新" data-force-refresh="false" '+$nr.route.url('form-refresh')+'><i class="fa fa-refresh rotation"></i> '+nrdd.name+'</a>';
        };
        nrhtm='';
        nrhtm+=' '+this.btn({name:''});
        nrhtm+=' <span class="btn btn-success btn-add " title="添加" '+$nr.route.url('category/list#category/edit')+'><i class="fa fa-plus"></i> 添加</span>';

        nrhtm+=' <a href="javascript:;" class="btn btn-success btn-edit btn-disabled" title="编辑"><i class="fa fa-pencil"></i> 编辑</a>';
        this.alls=nrhtm;
        nrhtm+=' <a href="javascript:;" class="btn btn-danger btn-del btn-disabled" title="删除"><i class="fa fa-trash"></i> 删除</a>';
        nrhtm+=' <div class="dropdown btn-group"> <a class="btn btn-primary btn-more dropdown-toggle btn-disabled" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-cog"></i> 更多</a> <ul class="dropdown-menu text-left" role="menu"> <li><a class="btn btn-link btn-multi btn-disabled" href="javascript:;" data-params="status=normal"><i class="fa fa-eye"></i> 设为正常</a></li> <li><a class="btn btn-link btn-multi btn-disabled" href="javascript:;" data-params="status=hidden"><i class="fa fa-eye-slash"></i> 设为隐藏</a></li> </ul> </div>';
        nrhtm+=' <a href="javascript:;" class="btn btn-danger btn-toggle-all"><i class="fa fa-plus"></i> 显示全部</a>';
        nrhtm+=' <a href="javascript:" class="btn btn-warning-light btn-selected-tips hide" data-animation="false" data-toggle="tooltip" data-title="点击取消全部"><i class="fa fa-info-circle"></i> 跨页选择模式，已选 <b>0</b> 项</a>';
        this.all=nrhtm;
        return this;
    },
    head_set:function(nrdd){
        return '<div class="fixed-table-toolbar"> <div class="bs-bars pull-left"><div class="toolbar"> '+this.listsetleft(['refresh,add,edit,disabled,more,toggle-all']).all+'</div></div> <div class="columns-right pull-right" style="margin-top:10px;margin-bottom:10px;"> <button class="btn btn-default" type="button" name="commonSearch" title="普通搜索"><i class="glyphicon glyphicon-search"></i></button> </div> <div class="columns columns-right btn-group pull-right"> <button class="btn btn-default" type="button" name="toggle" aria-label="toggle" title="切换"><i class="glyphicon glyphicon-list-alt icon-list-alt"></i></button> <div class="keep-open btn-group" title="列"> <button type="button" aria-label="columns" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-th icon-th"></i> <span class="caret"></span></button> <ul class="dropdown-menu" role="menu"> <li role="menuitem"> <label> <input type="checkbox" data-field="id" value="1" checked="checked"> ID</label> </li> <li role="menuitem"> <label> <input type="checkbox" data-field="username" value="2" checked="checked"> 用户名</label> </li> <li role="menuitem"> <label> <input type="checkbox" data-field="title" value="3" checked="checked"> 标题</label> </li> <li role="menuitem"> <label> <input type="checkbox" data-field="url" value="4" checked="checked"> Url</label> </li> <li role="menuitem"> <label> <input type="checkbox" data-field="ip" value="5" checked="checked"> IP</label> </li> <li role="menuitem"> <label> <input type="checkbox" data-field="browser" value="6" checked="checked"> Browser</label> </li> <li role="menuitem"> <label> <input type="checkbox" data-field="createtime" value="7" checked="checked"> 创建时间</label> </li> <li role="menuitem"> <label> <input type="checkbox" data-field="operate" value="8" checked="checked"> 操作</label> </li> </ul> </div> <div class="export btn-group"> <button class="btn btn-default dropdown-toggle" aria-label="export type" title="导出数据" data-toggle="dropdown" type="button"><i class="glyphicon glyphicon-export icon-share"></i> <span class="caret"></span></button> <ul class="dropdown-menu" role="menu"> <li role="menuitem" data-type="json"><a href="javascript:void(0)">JSON</a></li> <li role="menuitem" data-type="xml"><a href="javascript:void(0)">XML</a></li> <li role="menuitem" data-type="csv"><a href="javascript:void(0)">CSV</a></li> <li role="menuitem" data-type="txt"><a href="javascript:void(0)">TXT</a></li> <li role="menuitem" data-type="doc"><a href="javascript:void(0)">MS-Word</a></li> <li role="menuitem" data-type="excel"><a href="javascript:void(0)">MS-Excel</a></li> </ul> </div> </div> <div class="pull-right search"> <input class="form-control" type="text" placeholder="搜索"> </div> </div>';
        return '<div class="fixed-table-loading" style="top: 42px; display: none;">正在努力地加载数据中，请稍候……</div>';
    },
    page:{
      lang:{home:"首页",previous:"上一页",next:"下一页",back:"尾页"}, 
      showa:function(nrdd_name,nrdd_page){
          return '<li '+$nr.route.url('form-input|page|'+nrdd_page)+'><span>'+nrdd_name+'</span></li>';
      },
      showb:function(nrdd_name){
          return '<li class="disabled"><span>'+nrdd_name+'</span></li>';
      },
      pagenum:function(){
          nrarray=[10,15,20,25,50];
          nrhtm='<ul class="dropdown-menu" role="menu"> ';
          for(nrx in nrarray) {
          nrhtm+='<li role="menuitem"><a'+$nr.route.url('form-input|pagenum|'+nrarray[nrx])+'>'+nrarray[nrx]+'</a></li>'; 
          }
          return nrhtm+'</ul>';
      },
      

      page:function(nrdd){
            lastpage=nrdd.lastpage;  
            var  page_show=nrdd.pagenum;   
            lastpage=Math.floor((lastpage-1)/page_show)+1;  
            if(lastpage>1){  
              var  nrhtm="";   
              if(nrdd.page<=1){ 
                nrhtm+=this.showb(this.lang.home); 
                nrhtm+=this.showb(this.lang.previous); 
              }else{   
                nrhtm+=this.showa(this.lang.home,1); 
                nrhtm+=this.showa(this.lang.previous,(nrdd.page-1)); 
               }   
              range=2;  
              nrdd.page=nrdd.page*1;
              p_si=nrdd.page+range; 
              p_ci=nrdd.page-range;  
              p_ci=p_ci<1?1:p_ci; 
              p_si=p_si>=lastpage?lastpage:p_si;  
              s_ci=p_si-p_ci;
              if(s_ci<(range*2)){
                if(p_ci<range){ 
                  p_si=p_si+((range*2)-s_ci); 
                }else{  
                  p_ci=p_ci-((range*2)-s_ci); 
                }   
              }  
              p_si=p_si>=lastpage?lastpage:p_si;  
              if(nrdd.page>(range+1)){  
                nrhtm+="<li><span>...</span></li>"; 
              } 
              p_ci=p_ci<1?1:p_ci;  
              for(var i=p_ci;i<=p_si;i++){
                if(i==nrdd.page){ 
                  nrhtm+='<li class="active"><span>'+i+'</span></li>'; 
                }else{  
                  nrhtm+=this.showa(i,i);  
                }  
              } 
              if(lastpage>(range+nrdd.page)){ 
                nrhtm+="<li><span>...</span></li>"; 
              } 
              if(nrdd.page>=lastpage){
                nrhtm+=this.showb(this.lang.next); 
              }else{    
                nrhtm+=this.showa(this.lang.next,(nrdd.page*1+1));
              }  
              if(nrdd.page>=lastpage){  
                nrhtm+=this.showb(this.lang.back); 
              }else{  
                nrhtm+=this.showa(this.lang.back,lastpage);  
                }
               return '<div class="fixed-table-pagination" style="display: block;"> <div class="pull-left pagination-detail"><span class="pagination-info">显示'+nrdd.page+'/'+lastpage+'页 总共 '+nrdd.lastpage+' 条记录</span><span class="page-list">每页显示 <span class="btn-group dropup"> <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"><span class="page-size">'+nrdd.pagenum+'</span> <span class="caret"></span></button> '+this.pagenum()+' </span> 条记录</span></div> <div class="pull-right pagination"> <ul class="pagination">'+nrhtm+'</ul> </div> </div>';
            }else{   
              return "";   
            }
       }
    },
  },
  list:function(nrdd){
    nrhtm=this.public.head_set(nrdd);
    nrhtm+='<div class="fixed-table-container" style="padding-bottom: 0px;">';
    nrhtm+='<div class="fixed-table-header" style="display: none;"> <table> </table> </div> ';
    nrhtm+='<div class="fixed-table-body">';  
    nrhtm+='<div class="fixed-table-loading" style="top: 42px; display: none;">正在努力地加载数据中，请稍候……</div>';

    nrhtm+='<table id="table" class="table table-striped table-bordered table-hover" data-operate-edit="1" data-operate-del="1" width="100%">'; 
    nrhtm+='<thead><tr>';
    for(nrx in nrdd.thead){
      switch(nrx.substring(0,4)){
        case "sele":
           nrhtm+='<th class="bs-checkbox " style="text-align: center; vertical-align: middle; width: 36px; " data-field="state"><div class="th-inner "><input name="btSelectAll" type="checkbox" value="'+nrdd.thead[nrx]+'"></div><div class="fht-cell"></div></th>';
        break;
        case "name":
           nrhtm+='<th style="text-align: center; vertical-align: middle; " data-field="id"><div class="th-inner ">'+nrdd.thead[nrx]+'</div><div class="fht-cell"></div></th>';
        break;  
        case "left":
           nrhtm+='<th style="text-align: left; vertical-align: middle; " data-field="title"><div class="th-inner ">'+nrdd.thead[nrx]+'</div><div class="fht-cell"></div></th>';
        break;    
      }
    }
    nrhtm+='</tr></thead><tbody>';
    for(nrx in nrdd.data){
    nrhtm+='<tr data-index="'+nrdd.data[nrx].sele_id+'">';
     for(nrxt in nrdd.data[nrx]){
        switch(nrxt.substring(0,4)){
          case "sele":
             nrhtm+='<td class="bs-checkbox "><input name="btSelect[]" type="checkbox" value="'+nrdd.data[nrx][nrxt]+'"/></td>';
          break;
          case "name":
             nrhtm+='<td class="text-center">'+nrdd.data[nrx][nrxt]+'</td>';
          break;  
          case "left":
             nrhtm+='<td>'+nrdd.data[nrx][nrxt]+'</td>';
          break;      
          case "ctag":
             nrhtm+='<td class="text-center">'+$nr.css.tagall(nrdd.data[nrx][nrxt])+'</td>';
          break;  
          case "ptag":
             nrhtm+='<td class="text-center">'+$nr.css.ptag(nrdd.data[nrx][nrxt])+'</td>';
          break;  
        }
     }
    nrhtm+='</tr>';
    }
    nrhtm+='</tbody></table>';
    nrhtm+='</div> <div class="fixed-table-footer" style="display: none;"> <table> <tbody> <tr></tr> </tbody> </table> </div> '+this.public.page.page({lastpage:nrdd.total,page:nrdd.cur,pagenum:nrdd.pagenum})+' </div>';

    return nrhtm; },
  /*全部内容*/
  show:function(nrdd){
    nrdd={
      type:'',
      listinfo:'<em>分类管理</em>用于统一管理网站的所有分类,分类可进行无限级分类,分类类型请在常规管理-&gt;系统配置-&gt;字典配置中添加',
      listnav:{type:'type',value:'',data:[{name:'全部',vlaue:''},{name:'默认',vlaue:'d'},{name:'单页',vlaue:'page'},{name:'文章',vlaue:'w'},{name:'test',vlaue:'test'}]},
      form:{pagenum:'10',page:'1',url:'category/listdata'},
    };
    nrhtm='<input type="hidden" name="cmsurl" value="category">';
    nrhtm='<input type="hidden" name="page" value="'+nrdd.form.page+'">';
    nrhtm+='<input type="hidden" name="pagenum" value="'+nrdd.form.pagenum+'">';
    nrhtm+='<input type="hidden" name="type" value="'+nrdd.type+'">';
    return '<div class="row"> <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12"> <section class="content-header hide"> <h1> 控制台 <small>Control panel</small> </h1> </section> <div class="content"> <form class="nrsetform" method="POST" data-url="'+nrdd.form.url+'" action="javascript:;">'+nrhtm+' <div class="panel panel-default panel-intro"> <div class="panel-heading">'+this.public.listinfo(nrdd.listinfo)+' '+this.public.listnav(nrdd.listnav)+' </div> <div class="panel-body"> <div id="myTabContent" class="tab-content"> <div class="tab-pane fade active in" id="one"> <div class="widget-body no-padding"> '+this.public.head_input(nrdd)+' <div class="bootstrap-table"></div> <div class="clearfix"></div> </div> </div> </div> </div>  </div> </form></div> </div> </div>';
  },
};

